Coding by GuoyaoShen.
For more detail, please refer to the comments in codes.